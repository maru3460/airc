# マルチソース対応機能 - 概要

## 目的

airc に複数のソースから AI ツール設定ファイルをダウンロード・同期できる機能を追加し、以下のユースケースに対応する：

- **社内限定プロンプトの管理**: GitHub Organization の private リポジトリから設定を取得
- **ローカル開発環境**: ローカルにクローンしたリポジトリから直接インポート
- **複数プロジェクトの管理**: 公開プロジェクト、社内プロジェクト、個人プロジェクトなど複数ソースを登録して切り替え

## 背景・解決する課題

### 現状の制限

現在の airc は、以下の制限があります：

1. **単一ソース固定**: `maru3460/airc` リポジトリからのみダウンロード可能
2. **Public リポジトリのみ**: 認証機能がないため、Organization の private リポジトリに対応できない
3. **リモートのみ**: ローカルにクローンしたリポジトリから直接インポートできない
4. **設定の永続化なし**: 毎回リポジトリとプロジェクトを指定する必要がある

### 解決する課題

- **社内プロンプトの管理**: 社外に公開できないプロンプトやチャットモードを Organization リポジトリで管理
- **開発効率の向上**: よく使うソースを登録しておき、コマンド一発で同期
- **柔軟なワークフロー**: ローカルで編集→テスト→リモートに push という開発フローに対応

## 主要機能

### 1. ソース登録・管理機能

複数のソースを登録し、名前で管理できます：

```bash
# GitHub リポジトリを登録
airc add company github:my-org/ai-prompts --profile shared

# ローカルリポジトリを登録
airc add local-dev local:/path/to/repo

# 登録済みソースの一覧表示
airc list

# デフォルトソースの変更
airc set-default company
```

### 2. 設定の永続化

登録したソース情報（リポジトリ URL、認証情報、プロジェクト名など）を `~/.config/airc/config.json` に保存します。

### 3. 簡単な同期コマンド

一度登録すれば、次回以降はシンプルなコマンドで同期できます：

```bash
# 登録名で同期
airc sync company

# デフォルトソースを同期（引数省略）
airc sync

# 全ソースを一括同期
airc sync --all
```

### 4. 複数ソースタイプのサポート

- **GitHub Public リポジトリ**: 既存機能（認証不要）
- **GitHub Private リポジトリ**: GitHub Token を使った認証
- **ローカルリポジトリ**: ファイルシステムから直接コピー

### 5. 認証情報の安全な管理

GitHub Token などの認証情報は以下の方法で管理：

- 設定ファイルに保存（暗号化推奨）
- 環境変数から読み込み
- コマンド実行時に対話的に入力

## 後方互換性

既存の使い方も引き続きサポートします：

```bash
# 既存の使い方（変更なし）
airc              # → デフォルトソース（maru3460/airc/default）を使用
airc -p my-profile   # → maru3460/airc/{profile} を使用
```

初回起動時に、既存のデフォルトソース（`maru3460/airc`）を自動的に設定ファイルに登録します。

## 対象ユーザー

- **企業・組織の開発チーム**: 社内標準のプロンプトを共有したいチーム
- **複数プロジェクトを扱う開発者**: 用途別に複数の設定セットを使い分けたい開発者
- **プロンプト開発者**: ローカルで設定を編集・テストしたい開発者

## 次のステップ

- [使用例](./使用例.md): 具体的なコマンド例とユースケース
- [設計](./設計.md): 技術的な設計詳細
- [実装計画](./実装計画.md): 実装の進め方とフェーズ分け
