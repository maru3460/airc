# プロファイルを追加する

airc に新しい設定プロファイルを追加する方法を、ステップバイステップで説明します。

## プロファイルとは？

airc では、AI ツールの設定ファイルのセットを「プロファイル」として管理します。

例えば：
- **default**: すべての人が使える標準的な設定
- **team-alpha**: チーム Alpha 専用の設定
- **my-settings**: 個人用のカスタム設定

## 前提条件

プロファイルを追加するには、以下が必要です：

- **GitHub アカウント**: airc リポジトリへのアクセス権（または自分のフォークリポジトリ）
- **Git の基本知識**: clone, add, commit, push などの基本操作
- **Node.js 環境**: [02_環境構築.md](02_環境構築.md) を参照

## ステップバイステップガイド

### ステップ1: リポジトリをクローンする

まず、airc リポジトリをローカルにクローンします。

```bash
# airc リポジトリをクローン
git clone https://github.com/maru3460/airc.git
cd airc
```

**フォークして使う場合:**

```bash
# 1. GitHub で airc リポジトリをフォーク
# 2. フォークしたリポジトリをクローン
git clone https://github.com/<your-username>/airc.git
cd airc
```

### ステップ2: 新しいプロファイルディレクトリを作成する

`profiles/` ディレクトリ配下に、新しいプロファイル用のディレクトリを作成します。

```bash
# プロファイル名を 'my-profile' とする場合
mkdir -p profiles/my-profile
```

**ディレクトリ名の命名規則:**
- 小文字とハイフンを使用（例: `team-alpha`, `my-settings`）
- スペースや特殊文字は避ける

### ステップ3: 必要なディレクトリ構造を作成する

AI ツールの設定ファイルを配置するディレクトリを作成します。

```bash
# GitHub Copilot 用のディレクトリ
mkdir -p profiles/my-profile/.github/chatmodes
mkdir -p profiles/my-profile/.github/prompts
mkdir -p profiles/my-profile/.github/instructions

# Claude 用のディレクトリ
mkdir -p profiles/my-profile/.claude
```

**ディレクトリ構造の例:**

```
profiles/my-profile/
├── .github/
│   ├── chatmodes/        # GitHub Copilot チャットモード
│   ├── instructions/     # GitHub Copilot インストラクション
│   └── prompts/          # GitHub Copilot プロンプト
├── .claude/              # Claude 設定ファイル
└── CLAUDE.md             # Claude ルート設定
```

### ステップ4: 設定ファイルを作成する

必要な設定ファイルを作成・配置します。

**例1: GitHub Copilot プロンプト**

```bash
# プロンプトファイルを作成
cat > profiles/my-profile/.github/prompts/code-review.prompt.md << 'EOF'
---
title: コードレビュー支援
description: コードレビューのポイントを提案します
---

以下のコードをレビューしてください：
- コーディング規約に沿っているか
- バグや脆弱性がないか
- パフォーマンス上の問題がないか
- 可読性を改善できる箇所はないか
EOF
```

**例2: Claude 設定ファイル**

```bash
# Claude ルート設定を作成
cat > profiles/my-profile/CLAUDE.md << 'EOF'
# プロファイル設定

このプロファイルでは、以下のルールに従ってください：

## コーディング規約
- インデントは 2 スペース
- 変数名は camelCase を使用
- 関数にはコメントを記載

## 使用技術
- TypeScript
- Node.js
EOF
```

### ステップ5: マニフェストファイルを自動生成する

airc は、pre-commit hook を使ってマニフェストファイル（`files.json`）を自動生成します。

**方法1: Git Hook のセットアップ（推奨）**

```bash
# 依存関係をインストール（Git Hook も設定される）
npm install
```

これで、`git commit` 時に自動的に `files.json` が生成されます。

**方法2: 手動で生成する**

```bash
# マニフェスト生成スクリプトを実行
node scripts/generate-manifest.js
```

**生成される files.json の例:**

```json
{
  "version": "1.0",
  "files": [
    ".github/prompts/code-review.prompt.md",
    ".claude/instructions.md",
    "CLAUDE.md"
  ]
}
```

### ステップ6: Git にコミットする

新しいプロジェクトを Git にコミットします。

```bash
# ファイルをステージング
git add profiles/my-profile/

# コミット（pre-commit hook で files.json が自動生成される）
git commit -m "Add my-profile configuration"
```

**確認ポイント:**
- `files.json` が自動的に生成されているか確認してください
- コミットに `files.json` が含まれているか確認してください

```bash
# コミット内容を確認
git show --stat
```

### ステップ7: GitHub にプッシュする

変更を GitHub にプッシュします。

```bash
# メインブランチにプッシュ
git push origin main
```

**フォークを使っている場合:**
1. フォークリポジトリにプッシュ
2. 本家リポジトリに Pull Request を作成

### ステップ8: 動作確認

新しいプロジェクトが正しくダウンロードできるか確認します。

```bash
# テスト用ディレクトリを作成
mkdir test-download
cd test-download

# 新しいプロファイルをダウンロード
npx @maru3460/airc -p my-profile
```

**期待される出力:**

```
🚀 プロファイル 'my-profile' のファイルをダウンロードします...

📄 .github/prompts/code-review.prompt.md をダウンロード中...
✅ 保存しました: .github/prompts/code-review.prompt.md

📄 CLAUDE.md をダウンロード中...
✅ 保存しました: CLAUDE.md

✨ 完了! (2 件ダウンロード, 0 件スキップ, 0 件エラー)
```

## ファイル構成の例

### 最小構成

最小限のプロファイル構成は以下の通りです：

```
profiles/my-profile/
├── CLAUDE.md         # Claude ルート設定のみ
└── files.json        # 自動生成
```

### 標準構成

一般的なプロファイル構成は以下の通りです：

```
profiles/my-profile/
├── .github/
│   ├── prompts/
│   │   ├── code-review.prompt.md
│   │   └── refactor.prompt.md
│   └── instructions/
│       └── project-guidelines.instructions.md
├── .claude/
│   └── instructions.md
├── CLAUDE.md
└── files.json        # 自動生成
```

### 完全構成

すべての機能を使う場合の構成は以下の通りです：

```
profiles/my-profile/
├── .github/
│   ├── chatmodes/
│   │   └── expert.chatmode.md
│   ├── instructions/
│   │   ├── coding-style.instructions.md
│   │   └── security.instructions.md
│   └── prompts/
│       ├── code-review.prompt.md
│       ├── refactor.prompt.md
│       └── test.prompt.md
├── .claude/
│   ├── commands/
│   │   └── custom-command.md
│   └── instructions/
│       └── project-specific.md
├── CLAUDE.md
└── files.json        # 自動生成
```

## ベストプラクティス

### 1. プロファイル名は明確に

プロファイル名は、誰が使うものか分かりやすい名前にしましょう。

**良い例:**
- `team-backend` - バックエンドチーム用
- `frontend-react` - React用設定
- `personal-settings` - 個人用設定

**悪い例:**
- `profile1` - 何のプロファイルか不明
- `test` - 混乱の元

### 2. README を追加する

プロファイルディレクトリに README.md を追加し、設定の目的を説明しましょう。

```markdown
# My Profile 設定

このプロファイルは、チーム Alpha のバックエンド開発用の設定です。

## 含まれる設定
- TypeScript コーディング規約
- セキュリティチェック用プロンプト
- コードレビュー支援
```

### 3. 段階的に追加する

最初は最小構成から始め、必要に応じて設定を追加していくと良いでしょう。

```bash
# ステップ1: 最小構成を作成
mkdir -p profiles/my-profile
echo "# My Profile" > profiles/my-profile/CLAUDE.md

# ステップ2: 動作確認
git add profiles/my-profile/
git commit -m "Add minimal my-profile configuration"

# ステップ3: 設定を追加
mkdir -p profiles/my-profile/.github/prompts
# ファイルを追加...
git add profiles/my-profile/
git commit -m "Add prompts to my-profile"
```

### 4. 既存プロファイルを参考にする

既存のプロファイル（`default` など）を参考にして、ファイル構成を決めると良いでしょう。

```bash
# default プロジェクトの構成を確認
tree profiles/default/
```

## トラブルシューティング

### Q: files.json が自動生成されない

**A**: pre-commit hook が設定されていない可能性があります。

```bash
# npm install を実行して Git Hook をセットアップ
npm install

# または手動で生成
node scripts/generate-manifest.js
```

### Q: ダウンロード時に 404 エラーが出る

**A**: GitHub にプッシュされていない可能性があります。

```bash
# リモートリポジトリの状態を確認
git remote -v
git status

# プッシュされていなければプッシュ
git push origin main
```

### Q: 特定のファイルだけ除外したい

**A**: 現在、個別ファイルの除外には対応していません。ファイルをプロジェクトディレクトリに配置しなければ、マニフェストに含まれません。

## 次のステップ

プロファイルの追加ができたら、次は以下のいずれかに進んでください：

- **airc の仕組みを理解したい** → [05_仕組みを理解する.md](05_仕組みを理解する.md)
- **開発に参加したい** → [06_開発に参加する.md](06_開発に参加する.md)
